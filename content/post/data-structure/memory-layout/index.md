---
title: 메모리 레이아웃
description: 자료구조의 기초 이론을 학습합니다
slug: data-structure-memory-layout
date: 2024-11-13
categories:
  - data_structure
tags: 
  - theory
  - computer science
---

## 프로그램의 메모리 레이아웃과 그 중요성

프로그램이 실행될 때 메모리 상에 데이터가 어떻게 배치되는지에 대한 이해는 컴퓨터 공학에서 중요한 개념이다. 
C++ 프로그램이 실행될 때, 메모리는 여러 영역으로 나뉘며, 각 영역은 특정한 목적과 역할을 가진다. 
이러한 메모리 레이아웃을 통해 프로그램의 성능을 최적화하고, 메모리를 효율적으로 관리할 수 있다. 
이번 글에서는 메모리 레이아웃의 구성 요소와 그 작동 방식을 설명한다.

---

## 메모리 레이아웃의 구성 요소와 역할

### 코드 영역 (Code Segment 또는 Text Segment)

코드 영역은 실행할 프로그램의 **코드(명령어)**가 저장되는 메모리 공간이다.
이 영역에는 컴파일러가 생성한 실행 가능한 기계 코드가 위치하며, 프로그램이 실행되는 동안 **읽기 전용**으로 설정되어 수정할 수 없다. 
이로 인해 프로그램이 무결성을 유지할 수 있으며, 예기치 않은 수정으로 인한 에러 발생을 방지할 수 있다. 
코드 영역의 명령어는 CPU에 의해 순차적으로 실행되거나 특정 위치로 점프하는 제어 흐름이 발생하며, 프로그램의 전체적인 논리 흐름을 담당한다.

### 데이터 영역 (Data Segment)

데이터 영역은 프로그램의 **전역 변수**와 **정적 변수**가 저장되는 공간이다. 
데이터 영역은 두 가지 하위 영역으로 나뉘며, **초기화된 데이터 영역**과 **초기화되지 않은 데이터 영역(BSS)**로 구분된다.

- **초기화된 데이터 영역**은 초기값이 명시된 전역 변수와 정적 변수를 저장하며, 프로그램이 시작할 때 이 값들이 할당된다.
- **초기화되지 않은 데이터 영역(BSS)**에는 초기값이 명시되지 않은 전역 변수와 정적 변수가 위치하며, 프로그램 시작 시 자동으로 0으로 초기화된다.

이 두 하위 영역 덕분에 프로그램은 필요한 전역 변수를 효과적으로 관리할 수 있으며, 초기화 여부에 따라 메모리를 구분하여 사용한다.

### 힙 영역 (Heap Segment)

힙 영역은 **동적 메모리 할당**이 이루어지는 메모리 공간이다. 이 영역은 프로그램 실행 중 필요에 따라 메모리를 할당하고 해제할 수 있도록 지원한다. 
C++에서는 `new`와 `delete` 연산자를 사용하여 힙에 동적 메모리를 할당하거나 해제할 수 있으며, 
C 언어에서는 `malloc`과 `free` 함수를 사용하여 동적 메모리를 관리한다.

힙 영역은 주로 런타임에 크기가 결정되는 큰 데이터 구조(예: 동적 배열, 연결 리스트 등)를 저장할 때 사용되며, 할당과 해제를 명시적으로 관리해야 한다. 
만약 사용 후에 메모리를 해제하지 않으면 **메모리 누수**가 발생할 수 있으며, 이는 프로그램의 성능과 안정성에 부정적인 영향을 미칠 수 있다.

### 스택 영역 (Stack Segment)

스택 영역은 **함수 호출**과 관련된 지역 변수, 매개변수, 그리고 함수의 반환 주소를 저장하는 공간이다. 
함수가 호출될 때마다 스택에 **스택 프레임(Stack Frame)**이 생성되며, 함수 호출이 완료되면 해당 프레임이 스택에서 제거된다. 
스택은 LIFO(Last In, First Out) 원칙에 따라 작동하며, 자동으로 메모리 할당과 해제가 이루어진다.

스택은 재귀 호출이나 깊은 함수 호출이 많은 경우 **스택 오버플로(Stack Overflow)**를 일으킬 수 있으므로 사용에 주의가 필요하다. 
반면, 메모리 누수 위험이 적고 지역 변수를 효율적으로 관리할 수 있어, 함수 내부에서 사용하는 임시 데이터 저장에 매우 유용하다.

---

## 메모리 레이아웃 요약

C++ 프로그램의 메모리 구조는 다음과 같이 요약할 수 있다.

| 메모리 영역           | 역할                                | 특징                                      | 사용 예시                                |
|---------------------|-----------------------------------|-------------------------------------------|----------------------------------------|
| **코드 영역**         | 실행할 코드(명령어) 저장               | 읽기 전용, 수정 불가                           | 함수, 루프, 제어문이 실행되는 코드 부분         |
| **데이터 영역**       | 초기화된/초기화되지 않은 전역 및 정적 변수 | 프로그램 시작 시 메모리에 위치, 값 유지              | 초기화된 전역 변수 `int a = 10;`, 초기화 안된 전역 변수 `int b;` |
| **힙 영역**          | 동적 메모리 할당                    | 사용자 요청에 의해 크기와 할당 조절 가능, 명시적 해제 필요 | 런타임에 크기가 결정되는 배열이나 객체           |
| **스택 영역**         | 함수 호출 시 지역 변수, 매개변수, 반환 주소 저장 | 자동으로 메모리 할당과 해제, LIFO 방식           | 함수 호출 시 `int x = 5;` 같은 지역 변수     |

---

메모리 레이아웃은 프로그램의 성능과 안정성을 높이기 위한 필수적인 개념이다. 
프로그램이 사용하는 메모리 영역을 정확히 이해하고 관리함으로써 효율적인 메모리 사용을 실현할 수 있으며, 
이는 공학도로서 실무에서 유용하게 적용할 수 있는 기초적인 능력이다.

> [이전글: 자료구조](https://learngraphics.io/p/data-structure-intro/)

> [다음글: 배열](https://learngraphics.io/p/data-structure-array/)
